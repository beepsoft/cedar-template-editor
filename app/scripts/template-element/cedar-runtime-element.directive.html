<div ng-if="model !== undefined" class="item-root element-root"
    style="{{getNestingMargin(element, 0)}}">


  <div class="elementTotalContent ">

    <!--<div ng-show="$root.isArray(model)">-->
      <!--<div class="spreadsheetViewDetector"></div>-->
      <!--<div class="spreadsheetViewContainer"></div>-->
    <!--</div>-->

    <!-- for zero cardinality just show the element title because the valueArray is empty  -->
    <div ng-if="valueArray.length == 0">
      <div class="element " id="{{getLocator(i)}}" style="position:relative">
        <div class="flagpole"></div>

        <div ng-if="!isActive" class="left-tick"></div>

        <div class="row isInactive" ng-click="toggleExpanded(i);addElement()">
          <div class="col-sm-10">

            <button type="button" ng-click="toggleExpanded(i)"
                ng-class="{'xxx' : isExpanded(i), 'expand' : !isExpanded(i)}">
              <i ng-class="{'fa fa-caret-down ' : isExpanded(i), 'fa fa-caret-right ' : !isExpanded(i)}"></i>
            </button>
            <a class="element title" ng-class="{'isInactive' : isInactive(i)}">{{getTitle()}}</a>
          </div>
        </div>
      </div>
    </div>

    <!-- a paged list of elements -->
    <div ng-if="showMultiple('paged') && valueArray.length > 0">
      {{index}} {{valueArray}}

      <div class="element expand" id="{{getLocator(index)}}" style="position:relative">
        <div class="flagpole"></div>

        <div ng-if="!isActive" class="left-tick"></div>

        <div class="row isInactive">
          <div class="col-sm-6">

            <button type="button" class="xxx">
              <i class="fa fa-caret-down"></i>
            </button>

            <span ng-if="valueArray.length-1" class="count">{{index+1}}.</span>
            <a class="element title" ng-class="{'isInactive' : isInactive(index)}">{{getTitle()}}</a>
          </div>

          <cedar-pager values="valueArray" index="index" min="pageMin" max="pageMax" select="selectPage"
              range="pageRange" class="col-xs-4 " >
          </cedar-pager>

          <element-toolbar class="col-xs-2 "  model="model" index="index"
              remove="removeElement" add="addElement" active="isActive" toggle="toggleMultiple"
              paged="showMultiple('paged')" expanded="showMultiple('expanded')" cardinality="cardinalityString">
          </element-toolbar>

        </div>

        <div ui-sortable="$root.sortableOptions" ng-model="$root.schemaOf(element)._ui.order"
            class="sortable-container">
          <div ng-repeat="key in $root.schemaOf(element)['_ui']['order']">
            <div ng-if="$root.propertiesOf(element)[key]">
              <cedar-runtime-nested-element key="key"
                  field="$root.propertiesOf(element)[key]"
                  model="valueArray[index][key]"
                  remove-child="removeChild"
                  rename-child-key="renameChildKey"
                  is-edit-data="isEditData"
                  depth="depth+1"
                  path="path+'-'+index">
              </cedar-runtime-nested-element>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- an expanded list of elements -->
    <div ng-if="showMultiple('expanded')" ng-repeat="(i, valueElement) in valueArray">

      <div class="element" id="{{getLocator(i)}}" class='element-{{i}}' ng-class="{'expand' : isExpanded(i)}"
          style="position:relative">
        <div class="flagpole"></div>

        <div ng-if="!isActive" class="left-tick"></div>

        <div class="row isInactive" ng-click="toggleExpanded(i)">
          <div class="col-sm-10">

            <button type="button" ng-click="toggleExpanded(i)"
                ng-class="{'xxx' : isExpanded(i), 'expand' : !isExpanded(i)}">
              <i ng-class="{'fa fa-caret-down ' : isExpanded(i), 'fa fa-caret-right ' : !isExpanded(i)}"></i>
            </button>

            <span ng-if="valueArray.length-1" class="count">{{i+1}}.</span>
            <a class="element title" ng-class="{'isInactive' : isInactive(i)}">{{getTitle()}}</a>
          </div>


          <element-toolbar ng-if="isExpanded(i)" class="col-xs-2"  model="model"
              index="index"
              remove="removeElement" add="addElement" is-active="isActive" set-active="setActive" toggle="toggleMultiple"
              paged="showMultiple('paged')" expanded="showMultiple('expanded')"  cardinality="cardinalityString">
          </element-toolbar>


        </div>

        <div ng-if="isExpanded(i)" ui-sortable="$root.sortableOptions" ng-model="$root.schemaOf(element)._ui.order"
            class="sortable-container">
          <div ng-repeat="key in $root.schemaOf(element)['_ui']['order']">
            <div ng-if="$root.propertiesOf(element)[key]">
              <cedar-runtime-nested-element key="key"
                  field="$root.propertiesOf(element)[key]"
                  model="valueElement[key]"
                  remove-child="removeChild"
                  rename-child-key="renameChildKey"
                  is-edit-data="isEditData"
                  depth="depth+1"
                  path="path+'-'+i"
                  index="i">
              </cedar-runtime-nested-element>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>

</div>


