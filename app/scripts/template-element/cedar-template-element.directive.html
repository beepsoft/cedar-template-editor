<div ng-if="model !== undefined" class="element-root" id="{{$root.getDomId(element)}}"
     ng-click="canSelect(!isRootElement && !$root.isRuntime()); $event.preventDefault(); $event.stopPropagation()"
     ng-class="{'selected': isEditState(element)}">


    <!-- sort hander -->
    <div class="row" ng-show="!isRootElement">
        <div class="sortable-handler" style="height:30px;" ng-class="{'invisible': $root.isRuntime() }"
             ng-click="canSelect(!$root.isRuntime()); $event.preventDefault(); $event.stopPropagation()">
            <div class="type-label sortable"><span class="sortable-icon"></span></div>
        </div>
    </div>

    <!-- element title -->
    <div class="row" ng-show="!isRootElement">

        <div class="col-sm-9">

            <div class="form-group ">
                <h4>
                        <div ng-show="isEditState()" >
                            <input type="text"
                                   class="element-title-definition"
                                   style="font-size:18px; "
                                   placeholder="{{'CREATOR.enterElementTitle' | translate}}"
                                   aria-label="{{'CREATOR.enterElementTitle' | translate}}"
                                   ng-model="$root.schemaOf(element)._ui.title">


                        </div>

                        <div ng-show="!isEditState()" style="margin-left:30px;">
                            {{$root.schemaOf(element)._ui.title}}
                        </div>
                    </h4>
                </div>


            <div style="position:absolute;left:15px;top:3px">
                <a ng-click="switchExpandedState($root.getDomId(element))" class="visibilitySwitch"><i
                        class="cedar-svg-collapse"></i></a>
                <a ng-click="switchExpandedState($root.getDomId(element))" class="visibilitySwitch"
                   style="display:none;"><i
                        class="cedar-svg-expand"></i></a>
            </div>
        </div>





        <div class="col-sm-3">
            <div ng-show="$root.isRuntime()">

                <button type="button" class="help"
                        ng-class="{'invisible': $root.schemaOf(element)._ui.description.length == 0}"
                        tooltip="{{$root.schemaOf(element)._ui.description}}"
                        tooltip-trigger
                        tooltip-animation="true"
                        tooltip-placement="top"
                        data-toggle="tooltip"
                        style="border:0;outline:none">
                    <i class="fa fa-question"></i>
                </button>

                <button type="button" class="add noOutline"
                        tooltip="add"
                        ng-show="$root.isArray(model)"
                        tooltip-trigger
                        tooltip-animation="true"
                        tooltip-placement="top"
                        data-toggle="tooltip"
                        ng-click="addMoreInput()">
                    <i class="fa fa-plus"></i>
                </button>


                <button ng-show="$root.isArray(model) && $root.isRuntime()" type="button"
                        tooltip="show as spreadsheet"
                        tooltip-trigger
                        tooltip-animation="false"
                        tooltip-placement="top"
                        data-toggle="tooltip"
                        ng-click="switchToSpreadsheet()"
                        class="spreadsheetSwitchLink"
                        ng-show="true"
                        ng-disabled="preview" style="background:transparent;border:0;outline:none">
                    <i class="cedar-svg-spreadsheet"></i>
                </button>


            </div>
        </div>
    </div>


    <div class="elementTotalContent visible">
        <div ng-show="$root.isArray(model)">
            <div class="spreadsheetViewDetector"></div>
            <div class="spreadsheetViewContainer"></div>
        </div>

        <div class="elements originalContent">
            <div class="element-toggles list" ng-if="$root.isRuntime() && $root.elementIsMultiInstance(element)">

                <div class="element-toggle"
                     ng-class="{active: selectedTab == $index}"
                     ng-repeat="m in model"
                     ng-click="selectTab($index)"
                     ng-if="$root.isArray(model) && model.length > 0">
                    <span>{{$index + 1}}</span>
                </div>
                <div class="add-element">
                    <button type="button"
                            tooltip="add a {{$root.schemaOf(element)._ui.title}}"
                            tooltip-trigger
                            tooltip-animation="false"
                            tooltip-placement="top"
                            data-toggle="tooltip"
                            ng-click="addElement(); $event.stopPropagation();"
                            class="add zero noOutline"
                            ng-show="true"
                            ng-disabled="preview"
                            style="outline:none">
                        <i class="fa fa-plus"></i>
                    </button>
                </div>
                <div class="clearfix"></div>
            </div>
            <!-- /.date-type-toggle -->

            <!-- have an array with at least one element -->
            <div ng-if="$root.isArray(model) && selectedTab == $index" class="element" ng-repeat="m in model"
                 ng-class="['element-{{$index}}']">
                <div class="remove-element pull-right">
                    <a class="" ng-show="model.length > element.minItems" ng-click="removeElement($index)" translate>GENERIC.Remove</a>
                </div>

                <div ui-sortable="$root.sortableOptions" ng-model="$root.schemaOf(element)._ui.order"
                     class="sortable-container">
                    <div ng-repeat="key in $root.schemaOf(element)['_ui']['order']">
                        <div ng-if="$root.propertiesOf(element)[key]">
                            <cedar-nested-template-element key="key"
                                                           field="$root.propertiesOf(element)[key]"
                                                           model="m[key]"
                                                           remove-child="removeChild"
                                                           rename-child-key="renameChildKey">
                            </cedar-nested-template-element>
                        </div>
                    </div>
                </div>
            </div>

            <!-- have an array with no elements -->
            <div ng-if="!$root.isRuntime() && $root.isArray(model) && model.length == 0" class="element"
                 ng-class="['element-0']">
                <div ui-sortable="$root.sortableOptions" ng-model="element._ui.order" class="sortable-container">
                    <div ng-repeat="key in $root.schemaOf(element)['_ui']['order']">

                        <div ng-if="true">
                            <cedar-nested-template-element key="key"
                                                           field="$root.propertiesOf(element)[key]"
                                                           model="m[key]"
                                                           preview="preview" ,
                                                           remove-child="removeChild"
                                                           rename-child-key="renameChildKey"
                                    >
                            </cedar-nested-template-element>
                        </div>
                    </div>
                </div>
            </div>

            <!-- not an array -->
            <div ng-if="!$root.isArray(model)" class="element only-element" ui-sortable="$root.sortableOptions"
                 ng-model="element._ui.order">
                <div ng-repeat="key in $root.schemaOf(element)['_ui']['order']">
                    <div ng-if="$root.propertiesOf(element)[key]">
                        <cedar-nested-template-element key="key"
                                                       field="$root.propertiesOf(element)[key]"
                                                       model="model[key]"
                                                       remove-child="removeChild"
                                                       rename-child-key="renameChildKey">
                        </cedar-nested-template-element>
                    </div>
                </div>
            </div>
        </div>


    </div>


    <!-- element toolbar -->
    <div ng-show="isEditState() "
         style="border-top:1px solid #ccc;padding:10px;height:50px;">

        <div style="float:right" style="display: flex;flex-direction: row;justify-content: center;">


            <label translate>GENERIC.Multiple</label>
            <input tooltip="minimum required"
                   tooltip-trigger
                   tooltip-animation="true"
                   tooltip-placement="top"
                   data-toggle="tooltip" type="number" ng-model="element.minItems" title="min"
                   style="width:4em;margin-right:5px"
                   placeholder="min"/>

            <input tooltip="maximum allowed"
                   tooltip-trigger
                   tooltip-animation="true"
                   tooltip-placement="top"
                   data-toggle="tooltip" type="number" class="" ng-model="element.maxItems"
                   style="width:4em;margin-right:20px"
                   placeholder="max"
                   title="max"/>


            <div class="dropdown" style="font-size:20px;display:inline-block;margin-right:20px">
                <a class="dropdown-toggle"
                   type="button"
                   data-toggle="dropdown"
                   tooltip="add help text"
                   tooltip-trigger
                   tooltip-animation="true"
                   tooltip-placement="top"
                   data-toggle="tooltip"
                        ><i class="fa fa-question"></i>
                </a>

                <div class="dropdown-menu">
                   <textarea style="width:100%;height:100%;border:0px solid #fff" rows="5"
                             class="form-control"
                             ng-model="$root.schemaOf(element)._ui.description"></textarea>
                </div>
            </div>

            <a style="font-size:20px;display:inline-block;margin-right:20px"
               ng-click=" duplicate();$event.stopPropagation();"
               tooltip="duplicate element"
               tooltip-trigger
               tooltip-animation="true"
               tooltip-placement="top"
               data-toggle="tooltip"><i
                    class="fa fa-files-o"></i></a>


            <div style="font-size:20px;display:inline-block;margin-right:20px"></div>


            <a style="font-size:20px;display:inline-block;margin-right:20px"
               ng-click=" delete();$event.stopPropagation();"
               tooltip="delete element"
               tooltip-trigger
               tooltip-animation="true"
               tooltip-placement="top"
               data-toggle="tooltip"><i
                    class="fa fa-trash"></i></a>


        </div>
    </div>


</div>

