<div class="controlled-terms controlled-term-options">

  <div class="form-group floating-label-wrapper field-filter clearfix" ng-if="ctdc.filterSelection == 'field'">

    <controlled-term-search
        field-name="ctdc.field.finalTitle"
        search-mode="ctdc.filterSelection"
        reset-callback="ctdc.startOver"
        current-ontology="ctdc.currentOntology"
        selected-class="ctdc.selectedClass"
        is-loading-class-details="ctdc.isLoadingClassDetails"
        >
      <!--class-details="ctdc.classDetails"-->
      <!--current-ontology="ctdc.currentOntology"-->
      <!--include-create-class="true"-->
      <!--is-loading-class-details="ctdc.isLoadingClassDetails"-->
      <!--selected-class-1="ctdc.selectedClass"-->
      <!--selected-class-2="ctdc.selectedClass2"-->
    </controlled-term-search>

    <div class="class-actions">
      <div class="class-action" ng-if="ctdc.selectedClass.prefLabel">
        <span>Click OK to select the term <span class="highlighted">'{{ctdc.selectedClass.prefLabel}}'</span> from {{ctdc.currentOntology.info.id}}</span>

        <div>
          <button type="button" class="std-button btn btn-add-term"
              ng-click="ctdc.addClass(ctdc.selectedClass, ctdc.currentOntology); ctdc.startOver()">OK
          </button>
          <button type="button" class="std-button btn btn-add-term"
              ng-click="ctdc.addClass(ctdc.selectedClass, ctdc.currentOntology); ctdc.startOver()" data-dismiss="modal">
            Cancel
          </button>
        </div>
      </div>
    </div>

  </div>

  <div class="value-filter" ng-if="ctdc.filterSelection == 'values'">

    <controlled-term-search
        field-name="ctdc.field.finalTitle"
        search-mode="ctdc.filterSelection"
        reset-callback="ctdc.startOver"
        current-ontology="ctdc.currentOntology"
        selected-class="ctdc.selectedClass"
        is-loading-class-details="ctdc.isLoadingClassDetails">
    </controlled-term-search>

    <!--<cedar-controlled-term-value-set-picker-->
    <!--current-ontology="ctdc.currentOntology"-->
    <!--current-value-set="ctdc.currentValueSet"-->
    <!--include-create-class="true"-->
    <!--reset-callback="ctdc.startOver"-->
    <!--selected-value-result="ctdc.selectedClass">-->
    <!--</cedar-controlled-term-value-set-picker>-->


    <div class="class-actions">
      <!--Selected: OntologyClass-->
      <div ng-if="ctdc.selectedClass.type == 'OntologyClass'"
          ng-init="ctdc.stageValueConstraintAction = 'add_class'; ctdc.stageOntologyClassValueConstraint(ctdc.selectedClass)">
        <div class="element-toggles list table-style">
          <!--Add Term-->
          <div class="element-toggle table-cell-style"
              ng-class="{active: ctdc.stageValueConstraintAction == 'add_class'}"
              ng-click="ctdc.stageOntologyClassValueConstraint(ctdc.selectedClass)">
            <span>Add Term</span>
          </div>
          <!--Add Siblings-->
          <!--<div class="element-toggle table-cell-style"-->
              <!--ng-class="{active: ctdc.stageValueConstraintAction == 'add_siblings'}"-->
              <!--ng-click="ctdc.stageOntologyClassSiblingsValueConstraint(ctdc.selectedClass)">-->
            <!--<span>Add Siblings</span>-->
          <!--</div>-->
          <!--Add Children-->
          has children? {{ctdc.selectedClass}}
          <div ng-show="ctdc.selectedClass.hasChildren" class="element-toggle table-cell-style"
              ng-class="{active: ctdc.stageValueConstraintAction == 'add_children'}"
              ng-click="ctdc.stageBranchValueConstraint(ctdc.selectedClass)">
            <span>Add Children</span>
          </div>
          <!--Add Ontology-->
          <div class="element-toggle table-cell-style"
              ng-class="{active: ctdc.stageValueConstraintAction == 'add_ontology'}"
              ng-click="ctdc.stageOntologyValueConstraint()" ng-if="ctdc.currentOntology.info">
            <span>Add Ontology</span>
          </div>
        </div>
      </div>

      <!--Selected: ValueSet or Value-->
      <div ng-if="ctdc.selectedClass.type == 'ValueSet' || ctdc.selectedClass.type == 'Value'">
        <div class="element-toggles list table-style stage-value-constraint-actions">
          <div ng-if="ctdc.selectedClass['@id'] != ctdc.currentValueSet['@id']" class="element-toggle table-cell-style"
              ng-class="{active: ctdc.stageValueConstraintAction == 'add_class'}"
              ng-click="ctdc.stageOntologyClassValueConstraint(ctdc.selectedClass, 'Value')">
            <span>Class</span>
          </div>
          <div class="element-toggle table-cell-style"
              ng-class="{active: ctdc.stageValueConstraintAction == 'add_entire_value_set'}"
              ng-click="ctdc.stageValueSetValueConstraint()">
            <span>Value Set</span>
          </div>
        </div>
      </div>
    </div>


    <!-- Tabs content -->
    <div class="tabs-content add-terms-content" ng-if="ctdc.stageValueConstraintAction">
      <!--Add Entire Value Set-->
      <div class="staged-ontology-class-value-constraint"
          ng-if="ctdc.stageValueConstraintAction == 'add_entire_value_set' && ctdc.stagedValueSetValueConstraints.length > 0">
        <table class="table">
          <thead>
          <tr>
            <th>Values</th>
            <th>Type</th>
            <th>Source</th>
          </tr>
          </thead>
          <tbody>
          <tr ng-repeat="valueSet in ctdc.stagedValueSetValueConstraints">
            <td class="ontology-name">{{valueSet.numChildren}} values</td>
            <td class="type">Value Set</td>
            <td class="pref-label">{{valueSet.name}}</td>
          </tr>
          </tbody>
        </table>
        <div class="text-center">
          <button class="btn" ng-click="ctdc.addValueSetToValueConstraint()">Add</button>
        </div>
      </div>

      <!-- Add Ontology (tab content)-->
      <div class="staged-ontology-class-value-constraint"
          ng-if="ctdc.stageValueConstraintAction == 'add_ontology' && ctdc.stagedOntologyValueConstraints.length > 0">
        <table class="table">
          <thead>
          <tr>
            <th>Values</th>
            <th>Type</th>
            <th>Source</th>
          </tr>
          </thead>
          <tbody>
          <tr ng-repeat="ontology in ctdc.stagedOntologyValueConstraints">
            <td class="ontology-name">{{ontology.numChildren}} classes</td>
            <td class="type">Ontology</td>
            <td class="pref-label">{{ontology.name}} ({{ontology.acronym}})</td>
          </tr>
          </tbody>
        </table>
        <div class="text-center">
          <button class="btn" ng-click="ctdc.addOntologyToValueConstraint()">Add</button>
        </div>
      </div>

      <!--Add Children (content)-->
      <div class="floating-label-wrapper staged-ontology-class-value-constraint"
          ng-if="ctdc.stageValueConstraintAction == 'add_children' && ctdc.stagedBranchesValueConstraints.length > 0">
        <div class="staged-items table-style">
          <div class="form-group staged-item table-row-style"
              ng-repeat="constraint in ctdc.stagedBranchesValueConstraints">
            <div class="table-cell-style">
              {{constraint.name}}
            </div>
            <div class="table-cell-style floating-label-wrapper">
              <input placeholder="Maximum no. levels (default: 1)" type="textfield" class="form-control"
                  ng-model="constraint.maxDepth" with-floating-label/>
            </div>
          </div>
        </div>
        <div class="text-center">
          <button class="btn" ng-click="ctdc.addBranchToValueConstraint()">Add</button>
        </div>
      </div>

      <!--Add class (tab content)-->
      <div class="staged-ontology-class-value-constraint add-class-container"
          ng-if="ctdc.stageValueConstraintAction == 'add_class'">
        <table class="table">
          <thead>
          <tr>
            <th width="15%">Term</th>
            <th width="15%">UI Label</th>
            <th width="55%">URI</th>
            <th width="15%">Ontology</th>
          </tr>
          </thead>
          <tbody>
          <tr ng-repeat="class in ctdc.stagedOntologyClassValueConstraints">
            <td>{{class.prefLabel}}</td>
            <td><input type="textfield" class="form-control" ng-model="class.label" placeholder="{{class.prefLabel}}"/></td>
            <td>{{class.uri}}</td>
            <td>{{class.source}}</td>
          </tr>
          </tbody>
        </table>

        <!--<div class="staged-items table-style">-->
          <!--<div class="staged-item table-row-style"-->
              <!--ng-repeat="(key, constraint) in ctdc.stagedOntologyClassValueConstraints">-->
            <!--<div class="table-cell-style">-->
              <!--<input type="textfield" class="form-control" ng-model="constraint.label"-->
                  <!--placeholder="{{ctdc.stagedOntologyClassValueConstraintData[key].label}}"/>-->
            <!--</div>-->
            <!--<div class="table-cell-style floating-label-wrapper text-right action-cell">-->
              <!--<button class="btn" ng-click="ctdc.addOntologyClassToValueConstraint(constraint)">Add</button>-->
            <!--</div>-->
          <!--</div>-->
        <!--</div>-->
      </div>

      <!-- Add Siblings (content) -->
      <!--<div class="staged-ontology-class-value-constraint" ng-if="ctdc.stageValueConstraintAction == 'add_siblings'">-->
        <!--<div class="staged-items table-style">-->
          <!--<div class="staged-item table-row-style" ng-repeat="class in ctdc.stagedOntologyClassValueConstraints">-->
            <!--<table class="table">-->
              <!--<thead>-->
              <!--<tr>-->
                <!--<th width="15%">Term</th>-->
                <!--<th width="15%">UI Label</th>-->
                <!--<th width="55%">URI</th>-->
                <!--<th width="15%">Ontology</th>-->
              <!--</tr>-->
              <!--</thead>-->
              <!--<tbody>-->
              <!--<tr ng-repeat="class in ctdc.stagedOntologyClassValueConstraints">-->
                <!--<td>{{class.prefLabel}}</td>-->
                <!--<td><input type="textfield" class="form-control" ng-model="class.label" placeholder="{{class.prefLabel}}"/></td>-->
                <!--<td>{{class.uri}}</td>-->
                <!--<td>{{class.source}}</td>-->
              <!--</tr>-->
              <!--</tbody>-->
            <!--</table>-->
          <!--</div>-->
        <!--</div>-->
        <!--&lt;!&ndash;<div class="text-center">&ndash;&gt;-->
          <!--&lt;!&ndash;<button class="btn" ng-click="ctdc.addOntologyClassesToValueConstraint()">Add <span&ndash;&gt;-->
              <!--&lt;!&ndash;ng-if="ctdc.stagedOntologyClassValueConstraints.length == 1">Class</span><span&ndash;&gt;-->
              <!--&lt;!&ndash;ng-if="ctdc.stagedOntologyClassValueConstraints.length > 1">Collection</span></button>&ndash;&gt;-->
        <!--&lt;!&ndash;</div>&ndash;&gt;-->
      <!--</div>-->
    </div>


    <!--Class Actions-->
    <div class="class-action" ng-if="ctdc.stagedOntologyClassValueConstraints.length > 0">
      <span>Click OK to add the term(s) listed above</span>
      <div>
        <button type="button" class="std-button btn btn-add-term"
            ng-click="ctdc.addOntologyClassToValueConstraint(ctdc.stagedOntologyClassValueConstraints[0])">OK
        </button>
        <button type="button" class="std-button btn btn-add-term" ng-click="" data-dismiss="modal">
          Cancel
        </button>
      </div>
    </div>

  </div>
</div>
